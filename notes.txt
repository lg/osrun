things to consider for detection:

- using us english windows iso

after it working:

- disable windows update
- disable hibernate
- open ping
- enable rdp and open port
- disable uac
- unlimited password expiration

notes:

- run using `PACKER_LOG=1 packer build -timestamp-ui win11.packer.json`
- use a vnc client (not macos screen sharing) to connect to 127.0.0.1:5950
- run `qemu-system-x86_64 -cpu help` to get a list of cpus (and for other commands like accel too)
- if problems happen during the install, press Shift+F10 and `notepad x:\windows\panther\setuperr.log`

TODO:

- make it so the key doesnt need to be pressed a bunch of times
- that ProtectYourPC value, a website says 3
- ["-vga", "virtio"]
- optimize according to: https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/iot-ent-optimize-images?view=windows-11
  - Microsoft-Windows-Setup\ImageInstall\OSImage\Compact


unattend todo:
- clean up diskconfiguration and maybe use
- set fullname and organization in UserData
- set ComputerName in microsoft-windows-shell-setup
- set OEMInformation and OEMName in microsoft-windows-shell-setup

- downloading windows: https://github.com/quickemu-project/quickemu/blob/c7e91a0ea064f49223c20538431333340411f2e6/quickget#L2067






=================

        <!-- <RunSynchronousCommand wcm:action="add">
          <Order>1</Order>
          <Path>icacls "c:\programdata\Microsoft\Windows Defender\*" /remove:g *S-1-5-18 /T /C /L /Q</Path>
        </RunSynchronousCommand>
        <RunSynchronousCommand wcm:action="add">
          <Order>2</Order>
          <Path>icacls "c:\windows\system32\sppsvc.exe" /remove:g *S-1-5-18 /T /C /L /Q</Path>
        </RunSynchronousCommand>
        <RunSynchronousCommand wcm:action="add">
          <Order>1</Order>
          <Path>cmd</Path>
        </RunSynchronousCommand> -->



        qemu-system-x86_64 -m 8192M -cpu host -device qemu-xhci -device usb-tablet,bus=usb-bus.0 -device e1000,netdev=user.0 -machine type=q35,accel=kvm -boot once=d -netdev user,id=user.0,hostfwd=tcp::2844-:5985 -vnc 127.0.0.1:50 -smp 16 -name packer-qemu -drive file=output/packer-qemu,if=virtio,cache=writeback,discard=ignore,format=qcow2



bios: 18min 19s
efi: Xs

KB5027231 is the 2023-06 Cumulative Update for Windows 11 Version 22H2 for x64-Based Systems



qemu-system-x86_64 \
  -m 8192M \
  -smp 32 \
  -cpu host \
  -vga virtio \
  -vnc 127.0.0.1:50 \
  -device qemu-xhci \
  -device usb-tablet,bus=usb-bus.0 \
  -device virtio-net,netdev=user.0 \
  -drive file=output/packer-qemu,if=virtio,cache=writeback,discard=ignore,format=qcow2 \
  -netdev user,id=user.0,hostfwd=tcp::4403-:5985 \
  -name packer-qemu \
  -machine type=q35,accel=kvm \
  -boot c


# -fda /tmp/packer872549596 \
# -drive file=/root/arkalis-win/Win11_22H2_English_x64v2.iso,media=cdrom \
# -boot once=d \
# -cdrom virtio-win.iso





next:
- do console log
- make sure everythings deleted
- autologin
- add services to right click menu
- dont require virtio?


"qemuargs": [
        ["-cdrom", "virtio-win.iso"],
        ["-device", "qemu-xhci"],
        ["-device", "usb-tablet,bus=usb-bus.0"],
        ["-device", "pci-serial,chardev=c1"],
        ["-chardev", "stdio,id=c1,signal=off"]
      ],


      LANG=en-US
  for file in $(find /tmp/win11 -type f -iname "*.cab" -not -iname "*windows1*-kb*.cab" -not -iname "ssu-*.cab" -not -iname "*desktopdeployment*.cab" -not -iname "*aggregatedmetadata*.cab"); do
    fileName=$(basename $file .cab)
    echo "file: $file, fileName: $fileName"

    mkdir -p /tmp/win11/extract
    cabextract --keep-symlinks --directory /tmp/win11/extract $file
    wimlib-imagex capture /tmp/win11/extract "/tmp/win11/$fileName.esd" --no-acls --norpfix "Edition Package" "Edition Package"
  done










  (qemu) info chardev
info chardev
parallel0: filename=vc
compat_monitor0: filename=tcp:127.0.0.1:55555,server=on <-> 127.0.0.1:39189
serial0: filename=vc

(qemu) info block
info block
floppy0 (#block140): /cache/boot_disk.img (raw)
    Attached to:      /machine/unattached/device[46]
    Removable device: not locked, tray closed
    Cache mode:       writeback

virtio0 (#block378): /cache/win-building.qcow2 (qcow2)
    Attached to:      /machine/peripheral-anon/device[4]/virtio-backend
    Cache mode:       writeback, ignore flushes

ide0-cd0 (#block566): /cache/win11.iso (raw, read-only)
    Attached to:      /machine/unattached/device[52]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide1-cd0 (#block793): /cache/virtio-win.iso (raw, read-only)
    Attached to:      /machine/unattached/device[53]
    Removable device: not locked, tray closed
    Cache mode:       writeback

ide2-cd0: [not inserted]
    Attached to:      /machine/unattached/device[54]
    Removable device: not locked, tray closed

sd0: [not inserted]
    Removable device: not locked, tray closed

(qemu) info network
info network
e1000.0: index=0,type=nic,model=e1000,macaddr=52:54:00:12:34:56
 \ user.0: index=0,type=user,net=10.0.2.0,restrict=off

(qemu) info pci
info pci
  Bus  0, device   0, function 0:
    Host bridge: PCI device 8086:29c0
      PCI subsystem 1af4:1100
      id ""
  Bus  0, device   1, function 0:
    VGA controller: PCI device 1af4:1050
      PCI subsystem 1af4:1100
      IRQ 21, pin A
      BAR0: 32 bit prefetchable memory at 0xfe000000 [0xfe7fffff].
      BAR2: 64 bit prefetchable memory at 0xfe800000 [0xfe803fff].
      BAR4: 32 bit memory at 0xfebf4000 [0xfebf4fff].
      BAR6: 32 bit memory at 0xffffffffffffffff [0x0000fffe].
      id ""
  Bus  0, device   2, function 0:
    Class 0255: PCI device 1af4:1002
      PCI subsystem 1af4:0005
      IRQ 22, pin A
      BAR0: I/O at 0xc080 [0xc0bf].
      BAR4: 64 bit prefetchable memory at 0xfe804000 [0xfe807fff].
      id ""
  Bus  0, device   3, function 0:
    Ethernet controller: PCI device 8086:100e
      PCI subsystem 1af4:1100
      IRQ 23, pin A
      BAR0: 32 bit memory at 0xfebc0000 [0xfebdffff].
      BAR1: I/O at 0xc0c0 [0xc0ff].
      BAR6: 32 bit memory at 0xffffffffffffffff [0x0003fffe].
      id ""
  Bus  0, device   4, function 0:
    USB controller: PCI device 1b36:000d
      PCI subsystem 1af4:1100
      IRQ 0, pin A
      BAR0: 64 bit memory at 0xfebf0000 [0xfebf3fff].
      id ""
  Bus  0, device   5, function 0:
    SCSI controller: PCI device 1af4:1001
      PCI subsystem 1af4:0002
      IRQ 0, pin A
      BAR0: I/O at 0xc000 [0xc07f].
      BAR1: 32 bit memory at 0xfebf5000 [0xfebf5fff].
      BAR4: 64 bit prefetchable memory at 0xfe808000 [0xfe80bfff].
      id ""
  Bus  0, device  31, function 0:
    ISA bridge: PCI device 8086:2918
      PCI subsystem 1af4:1100
      id ""
  Bus  0, device  31, function 2:
    SATA controller: PCI device 8086:2922
      PCI subsystem 1af4:1100
      IRQ 0, pin A
      BAR4: I/O at 0xc140 [0xc15f].
      BAR5: 32 bit memory at 0xfebf6000 [0xfebf6fff].
      id ""
  Bus  0, device  31, function 3:
    SMBus: PCI device 8086:2930
      PCI subsystem 1af4:1100
      IRQ 10, pin A
      BAR4: I/O at 0x0700 [0x073f].
      id ""

(qemu) info usb
info usb
  Device 0.1, Port 1, Speed 480 Mb/s, Product QEMU USB Tablet

(qemu) info status
info status
VM status: running

(qemu) info snapshots
info snapshots
There is no snapshot available.

(qemu) info usernet
info usernet
Hub -1 (user.0):
  Protocol[State]    FD  Source Address  Port   Dest. Address  Port RecvQ SendQ
  TCP[ESTABLISHED]  131       10.0.2.15 49719    67.24.83.254    80     0     0
  TCP[ESTABLISHED]  137       10.0.2.15 49718   23.203.211.71   443     0     0
  TCP[ESTABLISHED]  134       10.0.2.15 49717    2.20.212.212   443     0     0
  TCP[ESTABLISHED]  130       10.0.2.15 49714   40.83.240.146   443     0     0
  TCP[ESTABLISHED]  148       10.0.2.15 49696        10.0.2.4   445     0     0
  TCP[ESTABLISHED]  133       10.0.2.15 49675   40.83.240.146   443     0     0
  TCP[ESTABLISHED]  149       10.0.2.15 49793   40.83.240.146   443     0     0
  TCP[ESTABLISHED]  153       10.0.2.15 49706   40.83.240.146   443     0     0
  TCP[HOST_FORWARD]  15               *  3389       10.0.2.15  3389     0     0
  TCP[HOST_FORWARD]  14               *  2222       10.0.2.15    22     0     0
  UDP[40 sec]       136       10.0.2.15 54366 239.255.255.250  1900     0     0
  UDP[33 sec]       129       10.0.2.15 50061     224.0.0.252  5355     0     0
  UDP[33 sec]       128               * 50061         0.0.0.0  5355     0     0
  UDP[33 sec]       127               * 55649         0.0.0.0  5355     0     0
  UDP[33 sec]       126               *  5353         0.0.0.0  5353     0     0
  UDP[36 sec]       124       10.0.2.15   137      10.0.2.255   137     0     0
  UDP[20 sec]       123       10.0.2.15 65039     224.0.0.252  5355     0     0
  UDP[20 sec]       122               * 65039         0.0.0.0  5355     0     0
  UDP[20 sec]       121       10.0.2.15 58186     224.0.0.252  5355     0     0
  UDP[20 sec]       120               * 58186         0.0.0.0  5355     0     0
  UDP[20 sec]       119       10.0.2.15  5353     224.0.0.251  5353     0     0
  UDP[20 sec]       118  169.254.113.84 62508     224.0.0.252  5355     0     0
  UDP[20 sec]       117               * 62508         0.0.0.0  5355     0     0
  UDP[20 sec]       115               *  5353         0.0.0.0  5353     0     0
  UDP[20 sec]       114  169.254.113.84  5353     224.0.0.251  5353     0     0
(qemu)

(qemu) info virtio
info virtio
/machine/peripheral-anon/device[4]/virtio-backend [virtio-blk]
/machine/peripheral-anon/device[0]/virtio-backend [virtio-balloon]
/machine/unattached/device[64]/virtio-backend [virtio-gpu]

(qemu) info qtree
info qtree
bus: main-system-bus
  type System
  dev: ps2-mouse, id ""
    gpio-out "" 1
  dev: ps2-kbd, id ""
    gpio-out "" 1
  dev: hpet, id ""
    gpio-in "" 2
    gpio-out "" 1
    gpio-out "sysbus-irq" 32
    timers = 3 (0x3)
    msi = false
    hpet-intcap = 16711940 (0xff0104)
    hpet-offset-saved = true
    mmio 00000000fed00000/0000000000000400
  dev: kvm-ioapic, id ""
    gpio-in "" 24
    gsi_base = 0 (0x0)
    mmio 00000000fec00000/0000000000001000
  dev: q35-pcihost, id ""
    MCFG = 2952790016 (0xb0000000)
    pci-hole64-size = 34359738368 (32 GiB)
    short_root_bus = 0 (0x0)
    below-4g-mem-size = 2147483648 (2 GiB)
    above-4g-mem-size = 15032385536 (14 GiB)
    x-pci-hole64-fix = true
    x-config-reg-migration-enabled = true
    bypass-iommu = false
    bus: pcie.0
      type PCIE
      dev: virtio-blk-pci, id ""
        disable-legacy = "off"
        disable-modern = false
        class = 0 (0x0)
        ioeventfd = true
        vectors = 33 (0x21)
        virtio-pci-bus-master-bug-migration = false
        migrate-extra = true
        modern-pio-notify = false
        x-disable-pcie = false
        page-per-vq = false
        x-ignore-backend-features = false
        ats = false
        x-ats-page-aligned = true
        x-pcie-deverr-init = true
        x-pcie-lnkctl-init = true
        x-pcie-pm-init = true
        x-pcie-flr-init = true
        aer = false
        addr = 05.0
        romfile = ""
        romsize = 4294967295 (0xffffffff)
        rombar = 1 (0x1)
        multifunction = false
        x-pcie-lnksta-dllla = true
        x-pcie-extcap-init = true
        failover_pair_id = ""
        acpi-index = 0 (0x0)
        x-pcie-err-unc-mask = true
        class SCSI controller, addr 00:05.0, pci id 1af4:1001 (sub 1af4:0002)
        bar 0: i/o at 0xc000 [0xc07f]
        bar 1: mem at 0xfebf5000 [0xfebf5fff]
        bar 4: mem at 0xfe808000 [0xfe80bfff]
        bus: virtio-bus
          type virtio-pci-bus
          dev: virtio-blk-device, id ""
            drive = "virtio0"
            backend_defaults = "auto"
            logical_block_size = 512 (512 B)
            physical_block_size = 512 (512 B)
            min_io_size = 0 (0 B)
            opt_io_size = 0 (0 B)
            discard_granularity = 4294967295 (4 GiB)
            write-cache = "auto"
            share-rw = false
            account-invalid = "auto"
            account-failed = "auto"
            rerror = "auto"
            werror = "auto"
            cyls = 16383 (0x3fff)
            heads = 16 (0x10)
            secs = 63 (0x3f)
            lcyls = 0 (0x0)
            lheads = 0 (0x0)
            lsecs = 0 (0x0)
            serial = ""
            config-wce = true
            scsi = false
            request-merging = true
            num-queues = 32 (0x20)
            queue-size = 256 (0x100)
            seg-max-adjust = true
            discard = true
            report-discard-granularity = true
            write-zeroes = true
            max-discard-sectors = 4194303 (0x3fffff)
            max-write-zeroes-sectors = 4194303 (0x3fffff)
            x-enable-wce-if-config-wce = true
            indirect_desc = true
            event_idx = true
            notify_on_empty = true
            any_layout = true
            iommu_platform = false
            packed = false
            queue_reset = true
            use-started = true
            use-disabled-flag = true
            x-disable-legacy-check = false
      dev: qemu-xhci, id ""
        addr = 04.0
        romfile = ""
        romsize = 4294967295 (0xffffffff)
        rombar = 1 (0x1)
        multifunction = false
        x-pcie-lnksta-dllla = true
        x-pcie-extcap-init = true
        failover_pair_id = ""
        acpi-index = 0 (0x0)
        x-pcie-err-unc-mask = true
        class USB controller, addr 00:04.0, pci id 1b36:000d (sub 1af4:1100)
        bar 0: mem at 0xfebf0000 [0xfebf3fff]
        bus: usb-bus.0
          type usb-bus
          dev: usb-tablet, id ""
            usb_version = 2 (0x2)
            display = ""
            head = 0 (0x0)
            port = ""
            serial = ""
            msos-desc = true
            pcap = ""
            addr 0.1, port 1, speed 480, name QEMU USB Tablet, attached
      dev: e1000, id ""
        mac = "52:54:00:12:34:56"
        netdev = "user.0"
        autonegotiation = true
        mitigation = true
        extra_mac_registers = true
        migrate_tso_props = true
        init-vet = true
        addr = 03.0
        romfile = "efi-e1000.rom"
        romsize = 262144 (0x40000)
        rombar = 1 (0x1)
        multifunction = false
        x-pcie-lnksta-dllla = true
        x-pcie-extcap-init = true
        failover_pair_id = ""
        acpi-index = 0 (0x0)
        x-pcie-err-unc-mask = true
        class Ethernet controller, addr 00:03.0, pci id 8086:100e (sub 1af4:1100)
        bar 0: mem at 0xfebc0000 [0xfebdffff]
        bar 1: i/o at 0xc0c0 [0xc0ff]
        bar 6: mem at 0xffffffffffffffff [0x3fffe]
      dev: virtio-balloon-pci, id ""
        disable-legacy = "off"
        disable-modern = false
        virtio-pci-bus-master-bug-migration = false
        migrate-extra = true
        modern-pio-notify = false
        x-disable-pcie = false
        page-per-vq = false
        x-ignore-backend-features = false
        ats = false
        x-ats-page-aligned = true
        x-pcie-deverr-init = true
        x-pcie-lnkctl-init = true
        x-pcie-pm-init = true
        x-pcie-flr-init = true
        aer = false
        addr = 02.0
        romfile = ""
        romsize = 4294967295 (0xffffffff)
        rombar = 1 (0x1)
        multifunction = false
        x-pcie-lnksta-dllla = true
        x-pcie-extcap-init = true
        failover_pair_id = ""
        acpi-index = 0 (0x0)
        x-pcie-err-unc-mask = true
        class Class 00ff, addr 00:02.0, pci id 1af4:1002 (sub 1af4:0005)
        bar 0: i/o at 0xc080 [0xc0bf]
        bar 4: mem at 0xfe804000 [0xfe807fff]
        bus: virtio-bus
          type virtio-pci-bus
          dev: virtio-balloon-device, id ""
            deflate-on-oom = false
            free-page-hint = false
            page-poison = true
            free-page-reporting = false
            qemu-4-0-config-size = false
            indirect_desc = true
            event_idx = true
            notify_on_empty = true
            any_layout = true
            iommu_platform = false
            packed = false
            queue_reset = true
            use-started = true
            use-disabled-flag = true
            x-disable-legacy-check = false
      dev: virtio-vga, id ""
        disable-legacy = "on"
        disable-modern = false
        ioeventfd = false
        vectors = 3 (0x3)
        virtio-pci-bus-master-bug-migration = false
        migrate-extra = true
        modern-pio-notify = false
        x-disable-pcie = false
        page-per-vq = false
        x-ignore-backend-features = false
        ats = false
        x-ats-page-aligned = true
        x-pcie-deverr-init = true
        x-pcie-lnkctl-init = true
        x-pcie-pm-init = true
        x-pcie-flr-init = true
        aer = false
        addr = 01.0
        romfile = "vgabios-virtio.bin"
        romsize = 65536 (0x10000)
        rombar = 1 (0x1)
        multifunction = false
        x-pcie-lnksta-dllla = true
        x-pcie-extcap-init = true
        failover_pair_id = ""
        acpi-index = 0 (0x0)
        x-pcie-err-unc-mask = true
        class VGA controller, addr 00:01.0, pci id 1af4:1050 (sub 1af4:1100)
        bar 0: mem at 0xfe000000 [0xfe7fffff]
        bar 2: mem at 0xfe800000 [0xfe803fff]
        bar 4: mem at 0xfebf4000 [0xfebf4fff]
        bar 6: mem at 0xffffffffffffffff [0xfffe]
        bus: virtio-bus
          type virtio-pci-bus
          dev: virtio-gpu-device, id ""
            max_outputs = 1 (0x1)
            edid = true
            xres = 1280 (0x500)
            yres = 800 (0x320)
            max_hostmem = 268435456 (256 MiB)
            blob = false
            indirect_desc = true
            event_idx = true
            notify_on_empty = true
            any_layout = true
            iommu_platform = false
            packed = false
            queue_reset = true
            use-started = true
            use-disabled-flag = true
            x-disable-legacy-check = false
      dev: ICH9-SMB, id ""
        addr = 1f.3
        romfile = ""
        romsize = 4294967295 (0xffffffff)
        rombar = 1 (0x1)
        multifunction = true
        x-pcie-lnksta-dllla = true
        x-pcie-extcap-init = true
        failover_pair_id = ""
        acpi-index = 0 (0x0)
        x-pcie-err-unc-mask = true
        class SMBus, addr 00:1f.3, pci id 8086:2930 (sub 1af4:1100)
        bar 4: i/o at 0x700 [0x73f]
        bus: i2c
          type i2c-bus
          dev: smbus-eeprom, id ""
            address = 87 (0x57)
          dev: smbus-eeprom, id ""
            address = 86 (0x56)
          dev: smbus-eeprom, id ""
            address = 85 (0x55)
          dev: smbus-eeprom, id ""
            address = 84 (0x54)
          dev: smbus-eeprom, id ""
            address = 83 (0x53)
          dev: smbus-eeprom, id ""
            address = 82 (0x52)
          dev: smbus-eeprom, id ""
            address = 81 (0x51)
          dev: smbus-eeprom, id ""
            address = 80 (0x50)
      dev: ich9-ahci, id ""
        addr = 1f.2
        romfile = ""
        romsize = 4294967295 (0xffffffff)
        rombar = 1 (0x1)
        multifunction = true
        x-pcie-lnksta-dllla = true
        x-pcie-extcap-init = true
        failover_pair_id = ""
        acpi-index = 0 (0x0)
        x-pcie-err-unc-mask = true
        class SATA controller, addr 00:1f.2, pci id 8086:2922 (sub 1af4:1100)
        bar 4: i/o at 0xc140 [0xc15f]
        bar 5: mem at 0xfebf6000 [0xfebf6fff]
        bus: ide.5
          type IDE
        bus: ide.4
          type IDE
        bus: ide.3
          type IDE
        bus: ide.2
          type IDE
          dev: ide-cd, id ""
            drive = "ide2-cd0"
            backend_defaults = "auto"
            logical_block_size = 512 (512 B)
            physical_block_size = 512 (512 B)
            min_io_size = 0 (0 B)
            opt_io_size = 0 (0 B)
            discard_granularity = 512 (512 B)
            write-cache = "auto"
            share-rw = false
            account-invalid = "auto"
            account-failed = "auto"
            rerror = "auto"
            werror = "auto"
            ver = "2.5+"
            wwn = 0 (0x0)
            serial = "QM00005"
            model = ""
            unit = 0 (0x0)
        bus: ide.1
          type IDE
          dev: ide-cd, id ""
            drive = "ide1-cd0"
            backend_defaults = "auto"
            logical_block_size = 512 (512 B)
            physical_block_size = 512 (512 B)
            min_io_size = 0 (0 B)
            opt_io_size = 0 (0 B)
            discard_granularity = 512 (512 B)
            write-cache = "auto"
            share-rw = false
            account-invalid = "auto"
            account-failed = "auto"
            rerror = "auto"
            werror = "auto"
            ver = "2.5+"
            wwn = 0 (0x0)
            serial = "QM00003"
            model = ""
            unit = 0 (0x0)
        bus: ide.0
          type IDE
          dev: ide-cd, id ""
            drive = "ide0-cd0"
            backend_defaults = "auto"
            logical_block_size = 512 (512 B)
            physical_block_size = 512 (512 B)
            min_io_size = 0 (0 B)
            opt_io_size = 0 (0 B)
            discard_granularity = 512 (512 B)
            write-cache = "auto"
            share-rw = false
            account-invalid = "auto"
            account-failed = "auto"
            rerror = "auto"
            werror = "auto"
            ver = "2.5+"
            wwn = 0 (0x0)
            serial = "QM00001"
            model = ""
            unit = 0 (0x0)
      dev: ICH9-LPC, id ""
        gpio-out "gsi" 24
        noreboot = false
        smm-compat = false
        smm-enabled = true
        x-smi-broadcast = true
        x-smi-cpu-hotplug = true
        x-smi-cpu-hotunplug = true
        addr = 1f.0
        romfile = ""
        romsize = 4294967295 (0xffffffff)
        rombar = 1 (0x1)
        multifunction = true
        x-pcie-lnksta-dllla = true
        x-pcie-extcap-init = true
        failover_pair_id = ""
        acpi-index = 0 (0x0)
        x-pcie-err-unc-mask = true
        class ISA bridge, addr 00:1f.0, pci id 8086:2918 (sub 1af4:1100)
        bus: isa.0
          type ISA
          dev: port92, id ""
            gpio-out "a20" 1
          dev: vmmouse, id ""
          dev: vmport, id ""
            x-read-set-eax = true
            x-signal-unsupported-cmd = true
            x-report-vmx-type = true
            x-cmds-v2 = true
            vmware-vmx-version = 6 (0x6)
            vmware-vmx-type = 2 (0x2)
          dev: i8042, id ""
            gpio-in "ps2-mouse-input-irq" 1
            gpio-in "ps2-kbd-input-irq" 1
            gpio-out "" 2
            gpio-out "a20" 1
            extended-state = true
            kbd-throttle = false
            kbd-irq = 1 (0x1)
            mouse-irq = 12 (0xc)
          dev: isa-fdc, id ""
            iobase = 1008 (0x3f0)
            irq = 6 (0x6)
            dma = 2 (0x2)
            fdtypeA = "auto"
            fdtypeB = "auto"
            fallback = "288"
            bus: floppy-bus.0
              type floppy-bus
              dev: floppy, id ""
                unit = 0 (0x0)
                drive = "floppy0"
                backend_defaults = "auto"
                logical_block_size = 512 (512 B)
                physical_block_size = 512 (512 B)
                min_io_size = 0 (0 B)
                opt_io_size = 0 (0 B)
                discard_granularity = 4294967295 (4 GiB)
                write-cache = "auto"
                share-rw = false
                account-invalid = "auto"
                account-failed = "auto"
                drive-type = "144"
          dev: isa-parallel, id ""
            index = 0 (0x0)
            iobase = 888 (0x378)
            irq = 7 (0x7)
            chardev = "parallel0"
          dev: isa-serial, id ""
            index = 0 (0x0)
            iobase = 1016 (0x3f8)
            irq = 4 (0x4)
          dev: isa-pcspk, id ""
            audiodev = ""
            iobase = 97 (0x61)
            migrate = true
          dev: kvm-pit, id ""
            gpio-in "" 1
            iobase = 64 (0x40)
            lost_tick_policy = "delay"
          dev: mc146818rtc, id ""
            gpio-out "" 1
            base_year = 0 (0x0)
            iobase = 112 (0x70)
            irq = 8 (0x8)
            lost_tick_policy = "discard"
          dev: kvm-i8259, id ""
            iobase = 160 (0xa0)
            elcr_addr = 1233 (0x4d1)
            elcr_mask = 222 (0xde)
            master = false
          dev: kvm-i8259, id ""
            iobase = 32 (0x20)
            elcr_addr = 1232 (0x4d0)
            elcr_mask = 248 (0xf8)
            master = true
          dev: i8257, id ""
            base = 192 (0xc0)
            page-base = 136 (0x88)
            pageh-base = -1 (0xffffffffffffffff)
            dshift = 1 (0x1)
          dev: i8257, id ""
            base = 0 (0x0)
            page-base = 128 (0x80)
            pageh-base = -1 (0xffffffffffffffff)
            dshift = 0 (0x0)
      dev: mch, id ""
        extended-tseg-mbytes = 16 (0x10)
        smbase-smram = true
        addr = 00.0
        romfile = ""
        romsize = 4294967295 (0xffffffff)
        rombar = 1 (0x1)
        multifunction = false
        x-pcie-lnksta-dllla = true
        x-pcie-extcap-init = true
        failover_pair_id = ""
        acpi-index = 0 (0x0)
        x-pcie-err-unc-mask = true
        class Host bridge, addr 00:00.0, pci id 8086:29c0 (sub 1af4:1100)
  dev: fw_cfg_io, id ""
    dma_enabled = true
    x-file-slots = 32 (0x20)
    acpi-mr-restore = true
  dev: kvmclock, id ""
    x-mach-use-reliable-get-clock = true
  dev: kvmvapic, id ""

